# Compliance minimization problem with 20x8 variables


## Software environment
* COMSOL Multiphysics 5.4
* Matlab 2019b
* Python 3.7
  * SciPy 1.2.0
  * PyTorch 1.2.0

## Code
* <strong>fluid.m</strong>: MATLAB script to generate a _COMSOL_ file, used to calculate pressure based on given density distribution
* <strong>fluid_optimized.m</strong>: MATLAB script to generate a _COMSOL_ file, used to calculate optimal configuration based on MMA and the adjoint method

* <strong>func_*.m</strong>: MATLAB function scripts
	* <strong>func_inputs_gen.m</strong>: a function to generate input data, i.e., $\rho$ in paper
	* <strong>func_outputs_nowrite.m</strong>: a function to calculate output, i.e., reciprocal of pressure, 1/P
	* <strong>func_test.m</strong>: a function to evaluate the optimized solution $\hat{\rho}$ from DNN
	* Others are used to plot
  
* <strong>main_*.m</strong>: MATLAB code to generate data
  	* <strong>main_greedy.m</strong>: code to implement our proposed SOLO-G algorithm, and generate data in subfolder "data_g"
	* <strong>main_regular.m</strong>: code to implement our proposed SOLO-R algorithm, and generate data in subfolder "data_r"

* <strong>plot_*.m</strong>: MATLAB code to plot the data
	* <strong>plot_c.m</strong>: plot figure c
	* <strong>plot_b_d_e.m</strong>: plot figures b, d, and e
	* <strong>plot_s4.m</strong>: plot Supplementary Figure 4
  
* <strong>bba.py</strong>: python code to implement Binary Bat Algorithm (BBA)
  
* <strong>utils.py</strong>: python utility code to check whether a design is feasible (fluid is not blocked by solid)

* <strong>mlopt.py</strong>: (abbreviation of Machine Learning and OPTimization) python code to train a Deep Learning Network (DNN) and obtain the optimized solution based on the DNN by BBA

## Data
If you run the code, data will be generated and stored in subfolders:
* <strong>data_g</strong>: data generated by the code "main_greedy.m" for SOLO-G
* <strong>data_r</strong>: data generated by the code "main_regular.m" for SOLO-R
  
You will also get a file:
* <strong>data_gb.mat</strong>: data generated by "plot_c.m" for the gradient-based method

Data is not uploaded to Github. Please download from [Google Drive](https://drive.google.com/drive/folders/1f6Xrd9e-RAUsh9vqIqUXbEw8F1_2Qg_5?usp=sharing) or email us.

## How to run
1. Connect MATLAB with _COMSOL_ server
2. Run __fluid.m__ by _COMSOL_ to generate __fluid.mph__
3. Run __main_greedy.m__ and __main_regular.m__
4. [optional] Run __plot_b_d_e.m__ and __plot_s4.m__
5. Run __fluid_optimized.m__ by _COMSOL_ to generate __fluid_optimized.mph__
6. [optional] Run __plot_c.m__
